# Machine-Number-Sense-Dataset  
Code for the AAAI-2020 paper  
Machine Number Sense: A Dataset of Visual Arithmetic Problems for Abstract and Relational Reasoning  
Wenhe Zhang, Chi Zhang, Yixin Zhu, Song-Chun Zhu  
_The 34th AAAI Conferences on Artificial Intelligence_, Februrary 7-12, New York (Oral
Presentation).  
  
As a comprehensive indicator of mathematical thinking and intelligence, the **number sense** bridges the induction of symbolic concepts and the competence of problem-solving. 
To endow such a crucial cognitive ability to machine intelligence, we propose a dataset, **Machine Number Sense (MNS)**, consisting of **visual** arithmetic problems automatically generated using a grammar model---AOG.  

These visual arithmetic problems are in the form of geometric figures: each problem has a set of geometric shapes as its **context** and embedded number **symbols**. 
Solving such problems is not trivial; the machine not only has to recognize the number, but also to interpret the number with its contexts, shapes, and relations (eg, symmetry) together with proper operations.  

We benchmark the MNS dataset using four predominant **neural network** models as baselines in this visual reasoning task. 
Comprehensive experiments show that current neural-network-based models still struggle to understand number concepts and relational operations. 
We show that a simple brute-force **search algorithm** could work out some of the problems without context information. 
Crucially, taking geometric context into account by an additional perception module would provide a sharp performance gain with fewer search steps. 
Altogether, we call for attention in fusing the classic search-based algorithms with modern neural networks to discover the essential number concepts in future research.

## Dataset Generation
The dataset is generated by by parsing and sampling an **And-Or Graph** (AOG) model. 
Each problem has an internal hierarchical tree structure composed of And-nodes and Or-nodes; 
an And-node denotes a decomposition of a larger entity in the grammar, 
and an Or-node denotes an alternative decomposition.  
- We design three problem types: (a) Combination, (b) Composition, and (c) Partition, each of which has a distinctive layout.
- Each problem contains two important components:  
  - Layout component serves as the **problem context**. The attributes vary with different problem types.
  - Algebra component serves as the **problem content**.
    A crucial attribute is the styles of interpretation, including holistic view and analytic view. 
    - From a **holistic perspective**, all the numbers in a panel are involved in the same calculation process together as a whole. 
    - From an **analytic perspective**, the numbers are grouped as several parts, and each part undergoes an individual calculation process.
    

## Benchmarks and Experiments  


## Usage
